<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Castle Model Generator</title>
    <meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
	<link type="text/css" rel="stylesheet" href="./css/index.css">
    <script src="https://unpkg.com/mathjs@8.1.1/lib/browser/math.js" type="text/javascript"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  </head>
  <body>
	
	<div id="menuBar"></div>

    <div id="sidePanel">
		<div id="toolbar">
			<button id="changeOrbit" class="Button selected">
				Orbit
			</button>
		</div>
		<div id="tabContainer">
			<span id="SceneTab" class="tab">Scene</span>
			<span id="CastleEditTab" class="tab">CastleEdit</span>
			<span id="PlaneControlTab" class="tab">PlaneControl</span>
			<span id="FovEstimationTab" class="tab">Fov Estimation</span>
			<span id="TestTab" class="tab">Test</span>
		</div>
		<div id="contentContainer">
			<div id="SceneContent" class="tabContent">
				<div class="panel">
					<div class="row" id="SceneGUIWrapper"></div>
				</div>
				<div class="panel">
					STATUS
					<div class="displayer" id="sceneStatus"></div>
					<div class="row">
						<button id="logStatus">Log Status</button>
					</div>
				</div>
				<div class="panel">
					<div class="row">
						<button id="exportObj">Export OBJ</button>
					</div>
					<div id="output">
						<!-- <button id="obj-output">obj出力</button> -->
						<a id="objExport" download="castle.obj">OBJ File</a><br>
						<a id="mtlExport" download="castle.mtl">MTL File</a>
					</div>
				</div>
			</div>
			<div id="CastleEditContent" class="tabContent">
				<div class="panel">
					<div class="row">
						<button id="startConstruction">START CONSTRUCTION</button>
					</div>
					<div class="row">
						<ul id="refPointsContainer">
							<li id="refPoint1" class="refPoint">P1</li>
							<li id="refPoint2" class="refPoint">P2</li>
							<li id="refPoint3" class="refPoint">P3</li>
							<li id="refPoint4" class="refPoint">P4</li>
						</ul>
					</div>
					<div class="row">
						<span class="rowTitle">P1</span>
						<input class="Number" id="P1x" autocomplete="off">
						<input class="Number" id="P1y" autocomplete="off">
						<input class="Number" id="P1z" autocomplete="off">
					</div>
					<div class="row">
						<span class="rowTitle">P2</span>
						<input class="Number" id="P2x" autocomplete="off">
						<input class="Number" id="P2y" autocomplete="off">
						<input class="Number" id="P2z" autocomplete="off">
					</div>
					<div class="row">
						<span class="rowTitle">P3</span>
						<input class="Number" id="P3x" autocomplete="off">
						<input class="Number" id="P3y" autocomplete="off">
						<input class="Number" id="P3z" autocomplete="off">
					</div>
					<div class="row">
						<span class="rowTitle">P4</span>
						<input class="Number" id="P4x" autocomplete="off">
						<input class="Number" id="P4y" autocomplete="off">
						<input class="Number" id="P4z" autocomplete="off">
					</div>
				</div>
				<div class="panel">
					<div class="displayer" id="castleOutliner"></div>
				</div>
				<div class="panel">
					<div class="row">
						<button id="addHafu" disabled>ADD HAFU</button>
					</div>
					<div class="row">
						<input class="Text" id="inputRoofColor" value="">
					</div>
					<div class="row">
						<button id="changeRoofColor" disabled>CHANGE ROOF COLOR</button>
					</div>
					<div class="row">
						<button id="removeWallTexture" disabled>REMOVE WALL TEXTURE</button>
					</div>
				</div>
				<div class="panel">
					<div class="row">
						<select id="selectModelPreset" class="Select" autocomplete="off"></select>
						<select id="selectModelType" class="Select" autocomplete="off">
							<option value="whole">whole</option>
							<option value="line">line</option>
							<option value="black">black</option>
						</select>
					</div>
					<div class="row">
						<button id="generatePresetModel">GENERATE PRESET MODEL</button>
					</div>
				</div>
			</div>
			<div id="PlaneControlContent" class="tabContent">
				<div class="panel">
					<div class="row">INPUT Background Image</div>
					<div class="row">
						<div id="background-change">
							<input type="file" class="background-Image" accept="image/*">
							<img id="preview">
						</div>
					</div>
				</div>
				<div class="panel">
					<div class="row">
						<button id="startPlaneEstimation">START PLANE ESTIMATION</button>
					</div>
					<div class="row">
						<button id="combine2DFix" disabled>COMBINE 2DFIX</button>
					</div>
					<div class="row">
						<button id="start2DFix">START 2DFIX</button>
					</div>
					<div class="row">
						<button id="convertTo3D" disabled>CONVERT To 3D</button>
					</div>
					<div class="row">
						<button id="clearPlaneEstimation">CLEAR PLANE ESTIMATION</button>
					</div>
					<div class="row">
						<button id="clear2DFix">CLEAR 2DFIX</button>
					</div>
					<div style="position: relative;">
						<canvas id="estimationCanvas" style="border: 1px solid #ccc;"></canvas>
					</div>
					<div id="openCVstatus">opencv.js 読み込み中</div>
				</div>
				<div class="panel">
					<div class="displayer" id="planeControlOutliner"></div>
				</div>
				<div class="panel">
					<div class="row" id="PlaneControlGUIWrapper"></div>
				</div>
			</div>
			<div id="FovEstimationContent" class="tabContent">
				<div class="panel">
					<div class="row">INPUT Background Image</div>
					<div class="row">
						<div id="background-change">
							<input type="file" class="background-Image" accept="image/*">
							<img id="preview">
						</div>
					</div>
				</div>
				<div class="panel">
					<div class="row">
						<select id="selectFovEstimationPreset" class="Select" autocomplete="off"></select>
					</div>
					<div class="row">
						<div id="fovEstimationTest">
							<!-- <input type="file" id="fovEstimationTestBackground" accept="image/*"> -->
							<button id="setFovEstimation">SET Fov Estimation</button>
						</div>
					</div>
					<div class="row">
						<button id="startFovEstimation">START Fov Estimation</button>
					</div>
					<div class="row">
						<button id="clearFovEstimation">CLEAR Fov Estimation</button>
					</div>
					<div class="row">
						<button id="getPresetParameters">GET Preset Parameters</button>
					</div>
					<div class="row">
						<button id="getModelData">GET Model Data</button>
					</div>
					<div class="panel">
						STATUS
						<div class="displayer" id="fovEstimationStatus"></div>
					</div>
				</div>
			</div>
			<div id="TestContent" class="tabContent">
				<div class="panel">
					<div class="row">
						<button id="gradientDescentCameraParameter">gradientDescentCameraParameter</button>
					</div>
					<div class="row">
						<button id="outputError">outputError</button>
					</div>
					<div class="row">
						<button id="generatePixelData">generatePixelData</button>
					</div>
					<div class="row">
						<button id="gradientDescentPrototype2">gradientDescentPrototype2</button>
					</div>
					<div class="row">
						<input id="pngFileName" type="text" value="Scene"><br>
						<button id="generatePixelPNG">generatePixelPNG</button>
					</div>
					<div class="row">
						<button id="raycasterPlane">raycasterPlane</button>
					</div>
					<div class="panel">
						STATUS
						<div class="displayer" id="testStatus"></div>
					</div>
				</div>
			</div>
		</div>
	</div>

	<div id="mainView">
		<canvas id="backgroundCanvas"></canvas>
		<img id="backgroundImage" style="display:none;">
		<div id="coverInfo">fov=90</div>
	</div>

    
    <script type="module" src="./js/index.js"></script>
	<script>
		// opencv.jsが読み込まれた後に実行される
		function onOpenCvReady() {
			document.getElementById("openCVstatus").innerHTML = "opencv.js 読み込み終了";
		}
	</script>
	<script async src="./opencv/opencv.js" onload="onOpenCvReady();"></script>
	<script src="/build/three.js"></script>
	<script src="/build/THREE.MeshLine.js"></script>


  </body>
</html>